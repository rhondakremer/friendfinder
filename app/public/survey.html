<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <title>Friend Finder Survey</title>
</head>

<body>
    <div class="container">
        <form>
            <div class="form-group">
                <label for="name">Name (Required)</label>
                <input type="name" class="form-control" id="name" placeholder="Chatty Kathy" required>
            </div>
            <div class="form-group">
                <label for="picture">Link to Photo (Required)</label>
                <input type="picture" class="form-control" id="picture" placeholder="http://yourimage.com">
            </div>

            <div class="form-group">
                <label for="question1">Dogs are the best pet.</label>
                <select class="form-control" id="question1" placeholder="Select an option">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question2">I need coffee to start my day.</label>
                <select class="form-control" id="question2">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question3">Talking to my mom every day is important.</label>
                <select class="form-control" id="question3">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question4">I am a morning person.</label>
                <select class="form-control" id="question4">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question5">I prefer being inside to being outside.</label>
                <select class="form-control" id="question5">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question6">I prefer beer to wine.</label>
                <select class="form-control" id="question6">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question7">Music is an important part of my life.</label>
                <select class="form-control" id="question7">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question8">I prefer hot weather to cold.</label>
                <select class="form-control" id="question8">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question9">I like cooking more than eating out.</label>
                <select class="form-control" id="question9">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="question10">Taco Bell is delicious.</label>
                <select class="form-control" id="question10">
                    <option value="empty">Select your option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary" id="submit">Find your friend!</button>
        </form>
        <div id="myModal1" class="modal">
            <div class="modal-content">
                <span class="close">x</span>
                <p>Your friend match is: </p>
                <p id="friendName"></p>
                <img src="#" id="friendPhoto" style="width:30%;">
            </div>
        </div>
    </div>



</body>

</html>

<script type="text/javascript">
    $("#submit").on("click", function (event) {
        //alert("you pushed submit")
        event.preventDefault();
        // Form validation
        var valid = true;
        let scores = [
                    $("#question1").val(),
                    $("#question2").val(),
                    $("#question3").val(),
                    $("#question4").val(),
                    $("#question5").val(),
                    $("#question6").val(),
                    $("#question7").val(),
                    $("#question8").val(),
                    $("#question9").val(),
                    $("#question10").val()
                ]
            console.log(scores)
        if ($("#name").val() === "" || $("#photo").val() === "") {
            valid = false;
        } 
        else if (scores.indexOf("empty") !== -1) {
            valid = false;
        }
        if (valid === true) {
            var newUser = {
                name: $("#name").val().trim(),
                photo: $("#picture").val().trim(),
                scores: scores
            };
            var currentURL = window.location.origin;
            // Ajax call for receiving response after POST req
            $.post(currentURL + "/api/friends", newUser, function (data) {
                $("#friendName").text(data.name);
                $("#friendPhoto").attr("src", data.photo);
                $("#myModal1").css("display", "block");

            });
        } else {
            // If a required field is missing, show alert
            alert("Survey is incomplete!");
        }
    });

//Logic for modal
var modal = $(".modal");
    var span = document.getElementsByClassName("close");
    // When the user clicks on <span> (x), close the modal
    span[0].onclick = function () {
        $(".modal").css("display", "none");
        window.location.replace("/");
    };
    window.onclick = function (event) {
        if (event.target == modal[0]) {
            $(".modal").css("display", "none");
        } else if (event.target == modal[1]) {
            $(".modal").css("display", "none");
        }
    };

</script>